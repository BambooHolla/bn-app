<ion-header>
  <ion-navbar color="transparent">
    <ion-title>{{'PAYMENT' | translate}}</ion-title>
  </ion-navbar>
</ion-header>
<ion-content>
  <div class="toolbar">
    <button class="tool-item qr-scan" (click)="routeTo('account-scan-add-contact',{auto_return:true,mode:'scan-only'})">
      <ali-icon name="ifm-scan"></ali-icon>
    </button>
    <button class="tool-item contact-book" (click)="routeTo('account-my-contacts',{auto_return:true,mode:'select-address'})">
      <ali-icon name="ifm-tongxunlu"></ali-icon>
    </button>
    <button class="tool-item ibt" (click)="routeTo('pay-receive')">
      <ali-icon name="ifm-IBT"></ali-icon>
    </button>
  </div>
  <div class="transfer">
    <div class="input-container">
      <ali-icon class="left" name="ifm-account-detail"></ali-icon>
      <input type="text" [(ngModel)]="formData.transfer_address" set-input-status="transfer_address" placeholder="{{'PLEASE_INPUT_ADDRESS' | translate}}" />
      <button class="right">
        <ali-icon name="ifm-scan"></ali-icon>
      </button>
    </div>
    <div class="input-container">
      <ali-icon class="left" name="ifm-amount"></ali-icon>
      <input type="number" [(ngModel)]="formData.transfer_amount" set-input-status="transfer_amount" placeholder="{{'PLEASE_INPUT_AMOUNT' | translate}}" />
    </div>
    <div class="input-container">
      <ali-icon class="left" name="ifm-duihua"></ali-icon>
      <input type="text" [(ngModel)]="formData.transfer_mark" set-input-status="transfer_mark" placeholder="{{'PLEASE_MARK_THE_TRANSACTION' | translate}}" disabled />
    </div>
    <div class="fee" (click)="setTransferFee()">
      <ali-icon class="left" name="ifm-info"></ali-icon>
      <span class="value">{{formData.transfer_fee|number:'1.8-8'}}</span>
      <div class="balance-info">{{'BALANCE' | translate}}：{{userInfo.balance|amountEuler|number:'1.8-8'}}</div>
    </div>
    <button class="submit-button" [disabled]="!canSubmit" (click)="submit()">{{'SUBMIT_TRANSFER' | translate}}</button>
  </div>
  <div class="roll-out-logs">
    <div class="title">
      <ali-icon class="left" name="ifm-roll-out-logs"></ali-icon>
      {{'RECENT_OUT_COME_RECORED' | translate}}
      <ali-icon class="right" name="ifm-arrow-dot-dot"></ali-icon>
    </div>
    <ion-content class="log-list">
      <!-- <ion-refresher (ionRefresh)="loadRollOutLogs($event)">
        <ion-refresher-content pullingText="下拉更新列表" refreshingText="正在更新转出记录……"></ion-refresher-content>
      </ion-refresher> -->
      <div class="log-item" *ngFor="let log of roll_out_logs;trackBy:listTrackBy" (click)="routeTo('chain-transaction-detail',{transaction:log})">
        <!-- <div class="create-time">{{log.create_time|amLocal:localName|amTimeAgo}}</div> -->
        <div class="create-time">{{(log.timestamp+timeago_clock)|timestamp|amLocale:localName|amTimeAgo}}</div>
        <div class="address" [innerHTML]="log.recipientId|mask:'@address'"></div>
        <div class="amount">{{log.amount|amountEuler|number:'1.8-8'}}</div>
      </div>
      <div class="empty" *ngIf="!roll_out_config.loading&&roll_out_logs.length==0">
        <i>{{'NO_OUT_COME_RECORED' | translate}}</i>
      </div>
      <ion-infinite-scroll (ionInfinite)="$event.waitFor(loadMoreRollOutLogs())" [enabled]="roll_out_config.has_more">
        <ion-infinite-scroll-content loadingText="{{'LOADING_OUT_COME_RECORED' | translate}}"></ion-infinite-scroll-content>
      </ion-infinite-scroll>
    </ion-content>
  </div>
  <div class="button-bg">
    <chain-mesh [auto-start]="true"></chain-mesh>
  </div>
</ion-content>
